https://babeljs.io/

https://babeljs.io/docs/

[TOC]

# Guides



## What is Babel?

#### Babel æ˜¯ä¸€ä¸ª JavaScript ç¼–è¯‘å™¨

Babel æ˜¯ä¸€ä¸ªå·¥å…·é“¾ï¼Œä¸»è¦ç”¨äºå°† ECMAScript 2015+ ä»£ç è½¬æ¢ä¸ºå½“å‰å’Œæ—§ç‰ˆæœ¬æµè§ˆå™¨æˆ–ç¯å¢ƒä¸­å‘åå…¼å®¹çš„ JavaScript ç‰ˆæœ¬ã€‚ä»¥ä¸‹æ˜¯ Babel å¯ä»¥ä¸ºæ‚¨åšçš„ä¸»è¦äº‹æƒ…ï¼š

* è½¬æ¢è¯­æ³•
* ç›®æ ‡ç¯å¢ƒä¸­ç¼ºå°‘çš„ Polyfill åŠŸèƒ½ï¼ˆé€šè¿‡ç¬¬ä¸‰æ–¹ Polyfillï¼Œä¾‹å¦‚ core-jsï¼‰
* æºä»£ç è½¬æ¢ï¼ˆcodemodsï¼‰

```js
// Babel Input: ES2015 arrow function
[1, 2, 3].map(n => n + 1);

// Babel Output: ES5 equivalent
[1, 2, 3].map(function(n) {
  return n + 1;
});
```

> Tip
>
> æœ‰å…³ç¼–è¯‘å™¨çš„ç²¾å½©æ•™ç¨‹ï¼Œè¯·æŸ¥çœ‹ [the-super-tiny-compiler](https://github.com/jamiebuilds/the-super-tiny-compiler)ï¼Œå®ƒè¿˜è§£é‡Šäº† Babel æœ¬èº«å¦‚ä½•åœ¨é«˜å±‚æ¬¡ä¸Šå·¥ä½œã€‚

#### ES2015 and beyond

Babel é€šè¿‡è¯­æ³•è½¬æ¢å™¨æ”¯æŒæœ€æ–°ç‰ˆæœ¬çš„ JavaScriptã€‚

è¿™äº›æ’ä»¶å…è®¸æ‚¨ç«‹å³ä½¿ç”¨æ–°è¯­æ³•ï¼Œè€Œæ— éœ€ç­‰å¾…æµè§ˆå™¨æ”¯æŒã€‚æŸ¥çœ‹æˆ‘ä»¬çš„ä½¿ç”¨æŒ‡å—ä»¥å¼€å§‹ä½¿ç”¨ã€‚

#### JSX and React

Babel å¯ä»¥è½¬æ¢ JSX è¯­æ³•ï¼æŸ¥çœ‹æˆ‘ä»¬çš„ React é¢„è®¾å³å¯å¼€å§‹ã€‚å°†å®ƒä¸ babel-sublime åŒ…ä¸€èµ·ä½¿ç”¨ï¼Œå°†è¯­æ³•é«˜äº®æ˜¾ç¤ºæå‡åˆ°ä¸€ä¸ªå…¨æ–°çš„æ°´å¹³ã€‚

```sh
npm install --save-dev @babel/preset-react
```

å¹¶å°† @babel/preset-react æ·»åŠ åˆ°ä½ çš„ Babel é…ç½®ä¸­ã€‚

#### Type Annotations (Flow and TypeScript)

Babel å¯ä»¥å»æ‰ç±»å‹æ³¨é‡Šï¼æŸ¥çœ‹æˆ‘ä»¬çš„ Flow é¢„è®¾æˆ– TypeScript é¢„è®¾å³å¯å¼€å§‹ä½¿ç”¨ã€‚è¯·è®°ä½ï¼ŒBabel ä¸è¿›è¡Œç±»å‹æ£€æŸ¥ï¼›æ‚¨ä»ç„¶éœ€è¦å®‰è£…å¹¶ä½¿ç”¨ Flow æˆ– TypeScript æ¥æ£€æŸ¥ç±»å‹ã€‚

```sh
npm install --save-dev @babel/preset-flow
```

```js
// @flow
function square(n: number): number {
  return n * n;
}
```

æˆ–æ‰“å­—ç¨¿é¢„è®¾

```sh
npm install --save-dev @babel/preset-typescript
```

```ts
function Greeter(greeting: string) {
  this.greeting = greeting;
}
```

#### Pluggable

Babel æ˜¯ç”±æ’ä»¶æ„å»ºçš„ã€‚ä½¿ç”¨ç°æœ‰æ’ä»¶æ„å»ºæ‚¨è‡ªå·±çš„è½¬æ¢ç®¡é“æˆ–ç¼–å†™æ‚¨è‡ªå·±çš„è½¬æ¢ç®¡é“ã€‚é€šè¿‡ä½¿ç”¨æˆ–åˆ›å»ºé¢„è®¾è½»æ¾ä½¿ç”¨ä¸€ç»„æ’ä»¶ã€‚

ä½¿ç”¨astexplorer.net å³æ—¶åˆ›å»ºæ’ä»¶æˆ–ä½¿ç”¨generator-babel-plugin ç”Ÿæˆæ’ä»¶æ¨¡æ¿ã€‚

#### Debuggable

æºæ˜ å°„æ”¯æŒï¼Œä»¥ä¾¿æ‚¨å¯ä»¥è½»æ¾è°ƒè¯•ç¼–è¯‘çš„ä»£ç ã€‚

#### Spec Compliant

Babel å°è¯•å°½å¯èƒ½åˆç†åœ°éµå®ˆ ECMAScript æ ‡å‡†ã€‚å®ƒè¿˜å¯èƒ½æœ‰ç‰¹å®šçš„é€‰é¡¹æ¥æ›´åŠ ç¬¦åˆè§„èŒƒï¼Œä½œä¸ºæ€§èƒ½çš„æƒè¡¡ã€‚

#### Compact

Babel å°è¯•ä½¿ç”¨å°½å¯èƒ½å°‘çš„ä»£ç ï¼Œè€Œä¸ä¾èµ–äºåºå¤§çš„è¿è¡Œæ—¶ã€‚

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½å¾ˆéš¾åšåˆ°ï¼Œå¹¶ä¸”å­˜åœ¨ä¸€äº›â€œå‡è®¾â€é€‰é¡¹ï¼Œå¯ä»¥åœ¨å¯è¯»æ€§ã€æ–‡ä»¶å¤§å°å’Œé€Ÿåº¦ä¹‹é—´æƒè¡¡è§„èŒƒåˆè§„æ€§ã€‚



## Usage Guide

Babel å·¥å…·é“¾ä¸­æœ‰ç›¸å½“å¤šçš„å·¥å…·è¯•å›¾è®©æ‚¨è½»æ¾ä½¿ç”¨ Babelï¼Œæ— è®ºæ‚¨æ˜¯â€œæœ€ç»ˆç”¨æˆ·â€è¿˜æ˜¯æ„å»º Babel æœ¬èº«çš„é›†æˆã€‚è¿™å°†æ˜¯å¯¹è¿™äº›å·¥å…·çš„å¿«é€Ÿä»‹ç»ï¼Œæ‚¨å¯ä»¥åœ¨æ–‡æ¡£çš„â€œç”¨æ³•â€éƒ¨åˆ†ä¸­é˜…è¯»æœ‰å…³å®ƒä»¬çš„æ›´å¤šä¿¡æ¯ã€‚

å¦‚æœæ‚¨ä½¿ç”¨æ¡†æ¶ï¼Œé…ç½® Babel çš„å·¥ä½œå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œæˆ–è€…å®é™…ä¸Šå·²ç»ä¸ºæ‚¨å¤„ç†å¥½äº†ã€‚è¯·æŸ¥çœ‹æˆ‘ä»¬çš„äº¤äº’å¼è®¾ç½®æŒ‡å—ã€‚

#### Overview

1. è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…è½¯ä»¶åŒ…ï¼š

```sh
yarn add --dev @babel/core @babel/cli @babel/preset-env
```

2. åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º babel.config.json ï¼ˆéœ€è¦ v7.8.0 åŠæ›´é«˜ç‰ˆæœ¬ï¼‰çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

```json
{
  "presets": [
    [
      "@babel/preset-env",
      {
        "targets": {
          "edge": "17",
          "firefox": "60",
          "chrome": "67",
          "safari": "11.1"
        },
        "useBuiltIns": "usage",
        "corejs": "3.6.5"
      }
    ]
  ]
}
```

æˆ–è€… babel.config.js å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯è¾ƒæ—§çš„ Babel ç‰ˆæœ¬

```js
const presets = [
  [
    "@babel/preset-env",
    {
      targets: {
        edge: "17",
        firefox: "60",
        chrome: "67",
        safari: "11.1",
      },
      useBuiltIns: "usage",
      corejs: "3.6.4",
    },
  ],
];

module.exports = { presets };
```

3. å¹¶è¿è¡Œæ­¤å‘½ä»¤å°†æ‰€æœ‰ä»£ç ä» src ç›®å½•ç¼–è¯‘åˆ° libï¼š

```sh
./node_modules/.bin/babel src --out-dir lib
```

> æ‚¨å¯ä»¥ä½¿ç”¨ npm@5.2.0 é™„å¸¦çš„ npm åŒ…è¿è¡Œç¨‹åºé€šè¿‡å°† ./node_modules/.bin/babel æ›¿æ¢ä¸º npx babel æ¥ç¼©çŸ­è¯¥å‘½ä»¤

#### Basic usage with CLI

æ‚¨éœ€è¦çš„æ‰€æœ‰ Babel æ¨¡å—éƒ½ä½œä¸ºå•ç‹¬çš„ npm åŒ…å‘å¸ƒï¼ŒèŒƒå›´åœ¨ @babel ä¸‹ï¼ˆè‡ªç‰ˆæœ¬ 7 èµ·ï¼‰ã€‚è¿™ç§æ¨¡å—åŒ–è®¾è®¡å…è®¸ä½¿ç”¨å„ç§å·¥å…·ï¼Œæ¯ç§å·¥å…·éƒ½é’ˆå¯¹ç‰¹å®šç”¨ä¾‹è€Œè®¾è®¡ã€‚è¿™é‡Œæˆ‘ä»¬å°†çœ‹çœ‹@babel/core å’Œ@babel/cliã€‚

###### Core Library

```sh
yarn add --dev @babel/core
```

ä½ å¯ä»¥ç›´æ¥åœ¨ JavaScript ç¨‹åºä¸­ require å®ƒå¹¶åƒè¿™æ ·ä½¿ç”¨å®ƒï¼š

```js
const babel = require("@babel/core");

babel.transformSync("code", optionsObject);
```

ä¸è¿‡ï¼Œä½œä¸ºæœ€ç»ˆç”¨æˆ·ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å®‰è£…å…¶ä»–å·¥å…·ä½œä¸º @babel/core çš„æ¥å£å¹¶ä¸æ‚¨çš„å¼€å‘è¿‡ç¨‹å¾ˆå¥½åœ°é›†æˆã€‚å³ä¾¿å¦‚æ­¤ï¼Œæ‚¨å¯èƒ½ä»ç„¶æƒ³æ£€æŸ¥å…¶æ–‡æ¡£é¡µé¢ä»¥äº†è§£è¿™äº›é€‰é¡¹ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†é€‰é¡¹ä¹Ÿå¯ä»¥ä»å…¶ä»–å·¥å…·è¿›è¡Œè®¾ç½®ã€‚

###### CLI tool

@babel/cli æ˜¯ä¸€ä¸ªå…è®¸ä½ ä»ç»ˆç«¯ä½¿ç”¨ babel çš„å·¥å…·ã€‚è¿™æ˜¯å®‰è£…å‘½ä»¤å’ŒåŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ï¼š

```sh
yarn add --dev @babel/core @babel/cli

./node_modules/.bin/babel src --out-dir lib
```

è¿™å°†è§£æ src ç›®å½•ä¸­çš„æ‰€æœ‰ JavaScript æ–‡ä»¶ï¼Œåº”ç”¨æˆ‘ä»¬å‘Šè¯‰å®ƒçš„ä»»ä½•è½¬æ¢ï¼Œå¹¶å°†æ¯ä¸ªæ–‡ä»¶è¾“å‡ºåˆ° lib ç›®å½•ã€‚ç”±äºæˆ‘ä»¬è¿˜æ²¡æœ‰å‘Šè¯‰å®ƒåº”ç”¨ä»»ä½•è½¬æ¢ï¼Œå› æ­¤è¾“å‡ºä»£ç å°†ä¸è¾“å…¥ç›¸åŒï¼ˆä¸ä¿ç•™ç¡®åˆ‡çš„ä»£ç æ ·å¼ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å®ƒä»¬ä½œä¸ºé€‰é¡¹ä¼ é€’æ¥æŒ‡å®šæˆ‘ä»¬æƒ³è¦çš„è½¬æ¢ã€‚

æˆ‘ä»¬åœ¨ä¸Šé¢ä½¿ç”¨äº† --out-dir é€‰é¡¹ã€‚æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ --help è¿è¡Œ cli å·¥å…·æ¥æŸ¥çœ‹è¯¥å·¥å…·æ¥å—çš„å…¶ä½™é€‰é¡¹ã€‚ä½†ç°åœ¨å¯¹æˆ‘ä»¬æ¥è¯´æœ€é‡è¦çš„æ˜¯ --plugins å’Œ --presetsã€‚

#### Plugins & Presets

è½¬æ¢ä»¥æ’ä»¶çš„å½¢å¼å‡ºç°ï¼Œå®ƒä»¬æ˜¯å°å‹ JavaScript ç¨‹åºï¼ŒæŒ‡å¯¼ Babel å¦‚ä½•å¯¹ä»£ç è¿›è¡Œè½¬æ¢ã€‚æ‚¨ç”šè‡³å¯ä»¥ç¼–å†™è‡ªå·±çš„æ’ä»¶æ¥å°†æ‚¨æƒ³è¦çš„ä»»ä½•è½¬æ¢åº”ç”¨åˆ°ä»£ç ä¸­ã€‚è¦å°† ES2015+ è¯­æ³•è½¬æ¢ä¸º ES5ï¼Œæˆ‘ä»¬å¯ä»¥ä¾èµ– @babel/plugin-transform-arrow-functions ç­‰å®˜æ–¹æ’ä»¶ï¼š

```sh
yarn add --dev @babel/plugin-transform-arrow-functions

./node_modules/.bin/babel src --out-dir lib --plugins=@babel/plugin-transform-arrow-functions
```

ç°åœ¨æˆ‘ä»¬ä»£ç ä¸­çš„ä»»ä½•ç®­å¤´å‡½æ•°éƒ½å°†è½¬æ¢ä¸º ES5 å…¼å®¹çš„å‡½æ•°è¡¨è¾¾å¼ï¼š

è¿™æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹ï¼ä½†æˆ‘ä»¬çš„ä»£ç ä¸­è¿˜æœ‰å…¶ä»–éœ€è¦è½¬æ¢çš„ ES2015+ åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œé¢„è®¾â€ï¼Œè€Œä¸æ˜¯é€ä¸€æ·»åŠ æˆ‘ä»¬æƒ³è¦çš„æ‰€æœ‰æ’ä»¶ï¼Œå®ƒåªæ˜¯ä¸€ç»„é¢„å…ˆç¡®å®šçš„æ’ä»¶ã€‚

å°±åƒä½¿ç”¨æ’ä»¶ä¸€æ ·ï¼Œæ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„é¢„è®¾æ¥å…±äº«æ‚¨éœ€è¦çš„æ’ä»¶çš„ä»»æ„ç»„åˆã€‚å¯¹äºæˆ‘ä»¬è¿™é‡Œçš„ç”¨ä¾‹ï¼Œæœ‰ä¸€ä¸ªåä¸º env çš„å‡ºè‰²é¢„è®¾ã€‚

```sh
yarn add --dev @babel/preset-env

./node_modules/.bin/babel src --out-dir lib --presets=@babel/env
```

æ— éœ€ä»»ä½•é…ç½®ï¼Œæ­¤é¢„è®¾å°†åŒ…å«æ”¯æŒç°ä»£ JavaScriptï¼ˆES2015ã€ES2016 ç­‰ï¼‰çš„æ‰€æœ‰æ’ä»¶ã€‚ä½†é¢„è®¾ä¹Ÿå¯ä»¥é‡‡ç”¨é€‰é¡¹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦ä¸€ç§ä¼ é€’é€‰é¡¹çš„æ–¹æ³•ï¼šé…ç½®æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä»ç»ˆç«¯ä¼ é€’ cli å’Œé¢„è®¾é€‰é¡¹ã€‚

#### Configuration

> æ ¹æ®æ‚¨çš„éœ€è¦ï¼Œæœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶ã€‚è¯·åŠ¡å¿…é˜…è¯»æˆ‘ä»¬å…³äºå¦‚ä½•é…ç½® Babel çš„æ·±å…¥æŒ‡å—ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º babel.config.json çš„æ–‡ä»¶ï¼ˆéœ€è¦ v7.8.0 åŠæ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

```json
{
  "presets": [
    [
      "@babel/preset-env",
      {
        "targets": {
          "edge": "17",
          "firefox": "60",
          "chrome": "67",
          "safari": "11.1"
        }
      }
    ]
  ]
}
```

ç°åœ¨ï¼Œenv é¢„è®¾å°†ä»…åŠ è½½ç›®æ ‡æµè§ˆå™¨ä¸­ä¸å¯ç”¨çš„åŠŸèƒ½çš„è½¬æ¢æ’ä»¶ã€‚æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½è¯­æ³•äº†ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹ Polyfillã€‚

#### Polyfill

> ğŸš¨ ä» Babel 7.4.0 å¼€å§‹ï¼Œè¿™ä¸ªåŒ…å·²è¢«å¼ƒç”¨ï¼Œè½¬è€Œç›´æ¥åŒ…å« core-js/stable ï¼ˆä»¥å¡«å…… ECMAScript åŠŸèƒ½ï¼‰ï¼š
>
> ```js
> import "core-js/stable";
> ```

@babel/polyfill æ¨¡å—åŒ…æ‹¬ core-js å’Œè‡ªå®šä¹‰å†ç”Ÿå™¨è¿è¡Œæ—¶æ¥æ¨¡æ‹Ÿå®Œæ•´çš„ ES2015+ ç¯å¢ƒã€‚

è¿™æ„å‘³ç€æ‚¨å¯ä»¥ä½¿ç”¨æ–°çš„å†…ç½®å‡½æ•°ï¼ˆå¦‚ Promise æˆ– WeakMapï¼‰ã€é™æ€æ–¹æ³•ï¼ˆå¦‚ Array.from æˆ– Object.assignï¼‰ã€å®ä¾‹æ–¹æ³•ï¼ˆå¦‚ Array.prototype.includesï¼‰ä»¥åŠç”Ÿæˆå™¨å‡½æ•°ï¼ˆä¸å†ç”Ÿå™¨æ’ä»¶ä¸€èµ·ä½¿ç”¨æ—¶ï¼‰ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œpolyfill æ·»åŠ åˆ°å…¨å±€èŒƒå›´ä»¥åŠæœ¬åœ°åŸå‹ï¼ˆå¦‚ Stringï¼‰ã€‚

å¯¹äºåº“/å·¥å…·ä½œè€…æ¥è¯´è¿™å¯èƒ½å¤ªå¤šäº†ã€‚å¦‚æœæ‚¨ä¸éœ€è¦åƒ Array.prototype.includes è¿™æ ·çš„å®ä¾‹æ–¹æ³•ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è½¬æ¢è¿è¡Œæ—¶æ’ä»¶è€Œä¸æ˜¯ @babel/polyfill æ¥å®Œå…¨ä¸æ±¡æŸ“å…¨å±€èŒƒå›´ã€‚

```sh
yarn add @babel/polyfill
```

> è¯·æ³¨æ„ --save é€‰é¡¹è€Œä¸æ˜¯ --save-devï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªéœ€è¦åœ¨æºä»£ç ä¹‹å‰è¿è¡Œçš„å¡«å……ç¨‹åºã€‚

ç°åœ¨å¯¹æˆ‘ä»¬æ¥è¯´å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ env é¢„è®¾æœ‰ä¸€ä¸ªâ€œuseBuiltInsâ€é€‰é¡¹ï¼Œå½“è®¾ç½®ä¸ºâ€œusageâ€æ—¶ï¼Œå®é™…ä¸Šå°†åº”ç”¨ä¸Šé¢æåˆ°çš„æœ€åä¸€ä¸ªä¼˜åŒ–ï¼Œå…¶ä¸­æ‚¨åªåŒ…å«æ‰€éœ€çš„ polyfillã€‚ä½¿ç”¨è¿™ä¸ªæ–°é€‰é¡¹ï¼Œé…ç½®ä¼šå‘ç”Ÿå¦‚ä¸‹å˜åŒ–ï¼š

```json
{
  "presets": [
    [
      "@babel/preset-env",
      {
        "targets": {
          "edge": "17",
          "firefox": "60",
          "chrome": "67",
          "safari": "11.1"
        },
        "useBuiltIns": "usage"
      }
    ]
  ]
}
```

Babel ç°åœ¨å°†æ£€æŸ¥æ‚¨çš„æ‰€æœ‰ä»£ç æ˜¯å¦æœ‰ç›®æ ‡ç¯å¢ƒä¸­ç¼ºå°‘çš„åŠŸèƒ½ï¼Œå¹¶ä¸”ä»…åŒ…å«æ‰€éœ€çš„ polyfillã€‚ä¾‹å¦‚è¿™æ®µä»£ç ï¼š



## Configure Babel

Babel å¯ä»¥é…ç½®ï¼è®¸å¤šå…¶ä»–å·¥å…·ä¹Ÿæœ‰ç±»ä¼¼çš„é…ç½®ï¼šESLint (.eslintrc)ã€Prettier (.prettierrc)ã€‚





# preset

## @babel/preset-env

@babel/preset-env æ˜¯ä¸€ä¸ªæ™ºèƒ½é¢„è®¾ï¼Œå…è®¸æ‚¨ä½¿ç”¨æœ€æ–°çš„ JavaScriptï¼Œè€Œæ— éœ€å¯¹ç›®æ ‡ç¯å¢ƒæ‰€éœ€çš„è¯­æ³•è½¬æ¢ï¼ˆä»¥åŠå¯é€‰çš„æµè§ˆå™¨å¡«å……ï¼‰è¿›è¡Œå¾®è§‚ç®¡ç†ã€‚è¿™æ—¢è®©æ‚¨çš„ç”Ÿæ´»æ›´è½»æ¾ï¼Œåˆè®© JavaScript åŒ…å˜å¾—æ›´å°ï¼

```sh
yarn add --dev @babel/preset-env
```

å¦‚æœæ²¡æœ‰ä¸€äº›å¾ˆæ£’çš„å¼€æºé¡¹ç›®ï¼Œæ¯”å¦‚ browserslistã€compat-table å’Œ electro-to-chromiumï¼Œ@babel/preset-env æ˜¯ä¸å¯èƒ½å®ç°çš„ã€‚

æˆ‘ä»¬åˆ©ç”¨è¿™äº›æ•°æ®æºæ¥ç»´æŠ¤æˆ‘ä»¬æ”¯æŒçš„ç›®æ ‡ç¯å¢ƒç‰ˆæœ¬è·å¾—äº† JavaScript è¯­æ³•æˆ–æµè§ˆå™¨åŠŸèƒ½æ”¯æŒçš„æ˜ å°„ï¼Œä»¥åŠè¿™äº›è¯­æ³•å’ŒåŠŸèƒ½åˆ° Babel è½¬æ¢æ’ä»¶å’Œ core-js polyfill çš„æ˜ å°„ã€‚

> Note
>
> @babel/preset-env ä¸ä¼šåŒ…å«ä»»ä½•ä½äºç¬¬ 3 é˜¶æ®µçš„ JavaScript è¯­æ³•ææ¡ˆï¼Œå› ä¸ºåœ¨ TC39 æµç¨‹çš„è¯¥é˜¶æ®µï¼Œä»»ä½•æµè§ˆå™¨éƒ½ä¸ä¼šå®ç°å®ƒã€‚è¿™äº›éœ€è¦æ‰‹åŠ¨åŒ…å«åœ¨å†…ã€‚ ShipedProposals é€‰é¡¹å°†åŒ…æ‹¬æŸäº›æµè§ˆå™¨å·²ç»å®ç°çš„ç¬¬ 3 é˜¶æ®µææ¡ˆã€‚

@babel/preset-env è·å–æ‚¨æŒ‡å®šçš„ä»»ä½•ç›®æ ‡ç¯å¢ƒï¼Œå¹¶æ ¹æ®å…¶æ˜ å°„æ£€æŸ¥å®ƒä»¬ï¼Œä»¥ç¼–è¯‘æ’ä»¶åˆ—è¡¨å¹¶å°†å…¶ä¼ é€’ç»™ Babelã€‚

#### Browserslist Integration

å¯¹äºåŸºäºæµè§ˆå™¨æˆ– Electron çš„é¡¹ç›®ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ .browserslistrc æ–‡ä»¶æ¥æŒ‡å®šç›®æ ‡ã€‚æ‚¨å¯èƒ½å·²ç»æ‹¥æœ‰æ­¤é…ç½®æ–‡ä»¶ï¼Œå› ä¸ºç”Ÿæ€ç³»ç»Ÿä¸­çš„è®¸å¤šå·¥å…·éƒ½åœ¨ä½¿ç”¨å®ƒï¼Œä¾‹å¦‚ autoprefixerã€stylelintã€eslint-plugin-compat ç­‰ã€‚

é»˜è®¤æƒ…å†µä¸‹@babel/preset-envå°†ä½¿ç”¨browserslisté…ç½®æºï¼Œé™¤éè®¾ç½®äº†targetsæˆ–ignoreBrowserslistConfigé€‰é¡¹ã€‚

> å¦‚æœæ‚¨ä¾èµ– browserslist çš„é»˜è®¤æŸ¥è¯¢ï¼ˆæ— è®ºæ˜¯æ˜ç¡®çš„è¿˜æ˜¯æ²¡æœ‰ browserslist é…ç½®ï¼‰ï¼Œæ‚¨å°†éœ€è¦æŸ¥çœ‹â€œæ— ç›®æ ‡â€éƒ¨åˆ†ä»¥è·å–æœ‰å…³é¢„è®¾ç¯å¢ƒè¡Œä¸ºçš„ä¿¡æ¯ã€‚

ä¾‹å¦‚ï¼Œä»…åŒ…å«æµè§ˆå™¨å¸‚åœºä»½é¢ >0.25% çš„ç”¨æˆ·æ‰€éœ€çš„å¡«å……å’Œä»£ç è½¬æ¢ï¼ˆå¿½ç•¥æ²¡æœ‰å®‰å…¨æ›´æ–°çš„æµè§ˆå™¨ï¼Œå¦‚ IE 10 å’Œ BlackBerryï¼‰ï¼š

```json
{
  "presets": [
    [
      "@babel/preset-env",
      {
        "useBuiltIns": "entry",
        "corejs": "3.22"
      }
    ]
  ]
}
```

.browserslistrc

```
> 0.25%
not dead
```

æˆ–è€… package.json

```json
{ "browserslist": "> 0.25%, not dead" }
```

#### Options

https://babeljs.io/docs/babel-preset-env

###### bugfixes é”™è¯¯ä¿®å¤

å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º falseã€‚

> Babel 8 ä¸­é»˜è®¤å¯ç”¨æ­¤é€‰é¡¹ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œ@babel/preset-envï¼ˆä»¥åŠä¸€èˆ¬çš„ Babel æ’ä»¶ï¼‰å°† ECMAScript è¯­æ³•åŠŸèƒ½åˆ†ç»„ä¸ºå¯†åˆ‡ç›¸å…³çš„è¾ƒå°åŠŸèƒ½çš„é›†åˆã€‚è¿™äº›ç»„å¯èƒ½å¾ˆå¤§å¹¶ä¸”åŒ…å«è®¸å¤šè¾¹ç¼˜æƒ…å†µï¼Œä¾‹å¦‚â€œå‡½æ•°å‚æ•°â€åŒ…æ‹¬è§£æ„å‚æ•°ã€é»˜è®¤å‚æ•°å’Œå‰©ä½™å‚æ•°ã€‚æ ¹æ®æ­¤åˆ†ç»„ä¿¡æ¯ï¼ŒBabel æ ¹æ®æ‚¨ä¸º @babel/preset-env çš„ Targets é€‰é¡¹æŒ‡å®šçš„æµè§ˆå™¨æ”¯æŒç›®æ ‡å¯ç”¨æˆ–ç¦ç”¨æ¯ä¸ªç»„ã€‚

å¯ç”¨æ­¤é€‰é¡¹åï¼Œ@babel/preset-env ä¼šå°è¯•å°†æŸåçš„è¯­æ³•ç¼–è¯‘ä¸ºç›®æ ‡æµè§ˆå™¨æ”¯æŒçš„æœ€æ¥è¿‘çš„æœªæŸåçš„ç°ä»£è¯­æ³•ã€‚æ ¹æ®æ‚¨çš„ç›®æ ‡ä»¥åŠæ‚¨ä½¿ç”¨çš„ç°ä»£è¯­æ³•çš„æ•°é‡ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ç¼–è¯‘çš„åº”ç”¨ç¨‹åºçš„å¤§å°æ˜¾ç€å‡å°ã€‚æ­¤é€‰é¡¹åˆå¹¶äº† @babel/preset-modules çš„åŠŸèƒ½ï¼Œè€Œæ— éœ€ä½¿ç”¨å…¶ä»–é¢„è®¾ã€‚



åˆ‡æ¢å¯ç”¨å¯¹æµè§ˆå™¨ä¸­é™„å¸¦çš„å†…ç½®/åŠŸèƒ½ææ¡ˆçš„æ”¯æŒã€‚å¦‚æœæ‚¨çš„ç›®æ ‡ç¯å¢ƒå¯¹åŠŸèƒ½ææ¡ˆå…·æœ‰æœ¬æœºæ”¯æŒï¼Œåˆ™ä¼šå¯ç”¨å…¶åŒ¹é…çš„è§£æå™¨è¯­æ³•æ’ä»¶ï¼Œè€Œä¸æ˜¯æ‰§è¡Œä»»ä½•è½¬æ¢ã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸ä¼šå¯ç”¨ä¸ @babel/preset-stage-3 ç›¸åŒçš„è½¬æ¢ï¼Œå› ä¸ºææ¡ˆåœ¨ç™»é™†æµè§ˆå™¨ä¹‹å‰å¯ä»¥ç»§ç»­æ›´æ”¹ã€‚





## @babel/preset-react

This preset always includes the following plugins:

- [@babel/plugin-syntax-jsx](https://babeljs.io/docs/babel-plugin-syntax-jsx)
- [@babel/plugin-transform-react-jsx](https://babeljs.io/docs/babel-plugin-transform-react-jsx)
- [@babel/plugin-transform-react-display-name](https://babeljs.io/docs/babel-plugin-transform-react-display-name)

And with the `development` option:

å¹¶ä½¿ç”¨å¼€å‘é€‰é¡¹ï¼š

Classic runtime adds:

ç»å…¸è¿è¡Œæ—¶æ·»åŠ ï¼š

- [@babel/plugin-transform-react-jsx-self](https://babeljs.io/docs/babel-plugin-transform-react-jsx-self)
- [@babel/plugin-transform-react-jsx-source](https://babeljs.io/docs/babel-plugin-transform-react-jsx-source)

Automatic runtime (since `v7.9.0`) adds the functionality for these plugins automatically when the `development` option is enabled. If you have automatic runtime enabled, adding [@babel/plugin-transform-react-jsx-self](https://babeljs.io/docs/babel-plugin-transform-react-jsx-self) or [@babel/plugin-transform-react-jsx-source](https://babeljs.io/docs/babel-plugin-transform-react-jsx-source) will error.

å½“å¯ç”¨å¼€å‘é€‰é¡¹æ—¶ï¼Œè‡ªåŠ¨è¿è¡Œæ—¶ï¼ˆè‡ª v7.9.0 èµ·ï¼‰ä¼šè‡ªåŠ¨æ·»åŠ è¿™äº›æ’ä»¶çš„åŠŸèƒ½ã€‚å¦‚æœå¯ç”¨äº†è‡ªåŠ¨è¿è¡Œæ—¶ï¼Œæ·»åŠ  @babel/plugin-transform-react-jsx-self æˆ– @babel/plugin-transform-react-jsx-source å°†ä¼šå‡ºé”™ã€‚

```sh
yarn add --dev @babel/preset-react
```



